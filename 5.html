<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dynamic Sort Ballot</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        /* --- THEME VARIABLES --- */
        :root {
            /* Dark Mode */
            --bg-body: #050505;
            --bg-zone: rgba(255, 255, 255, 0.03);
            --bg-card: #151515;
            --text-main: #ffffff;
            --text-muted: #888;
            --border-subtle: rgba(255,255,255,0.1);
            
            /* Ranks */
            --gold: #FFD700;
            --silver: #C0C0C0;
            --bronze: #CD7F32;
            --rank-other: #3b82f6;

            /* Button */
            --btn-bg: #fff;
            --btn-text: #000;
        }

        body.light-mode {
            --bg-body: #F0F2F5;
            --bg-zone: rgba(0, 0, 0, 0.03);
            --bg-card: #FFFFFF;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --border-subtle: rgba(0,0,0,0.1);
            --btn-bg: #000;
            --btn-text: #fff;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; background-color: var(--bg-body);
            color: var(--text-main); font-family: 'Outfit', sans-serif;
            padding-bottom: 120px; transition: 0.3s;
        }

        /* --- HEADER --- */
        header {
            padding: 20px; text-align: center;
            background: var(--bg-body); position: sticky; top: 0; z-index: 50;
            border-bottom: 1px solid var(--border-subtle);
            backdrop-filter: blur(10px);
        }
        .logo { font-weight: 800; letter-spacing: 2px; font-size: 1.1rem; text-transform: uppercase; }
        .sub-logo { font-size: 0.65rem; color: var(--text-muted); letter-spacing: 1px; margin-top: 5px; }
        
        .theme-btn {
            position: absolute; right: 20px; top: 25px;
            background: none; border: none; color: var(--text-main);
            font-size: 1.2rem; cursor: pointer;
        }

        /* --- LAYOUT --- */
        .container { max-width: 500px; margin: 0 auto; padding: 20px 15px; }

        .category-block { margin-bottom: 50px; }
        
        .cat-title {
            text-align: center; font-size: 0.9rem; font-weight: 700;
            text-transform: uppercase; letter-spacing: 2px; color: var(--text-muted);
            margin-bottom: 15px;
        }

        /* --- ZONES --- */
        .rank-zone {
            min-height: 90px;
            background: var(--bg-zone);
            border: 1px dashed var(--border-subtle);
            border-radius: 16px;
            padding: 10px;
            display: flex; gap: 10px; overflow-x: auto;
            align-items: center;
            margin-bottom: 20px;
            position: relative;
        }
        
        .rank-zone::before {
            content: 'Tap candidates below to rank them';
            position: absolute; width: 100%; text-align: center;
            font-size: 0.7rem; color: var(--text-muted); opacity: 0.5;
            pointer-events: none;
        }
        .rank-zone:not(:empty)::before { display: none; }

        .pool-zone {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
        }

        /* --- CARD --- */
        .card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 10px;
            display: flex; flex-direction: column; align-items: center;
            cursor: pointer; position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            transition: transform 0.2s, box-shadow 0.2s;
            animation: fadeIn 0.4s;
            border: 1px solid var(--border-subtle);
        }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        .card:active { transform: scale(0.95); }

        .img-wrap {
            width: 55px; height: 55px; border-radius: 50%;
            overflow: hidden; margin-bottom: 8px;
            position: relative; border: 2px solid transparent;
        }
        .img-wrap img { width: 100%; height: 100%; object-fit: cover; }
        .img-wrap i { 
            width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;
            background: #222; color: #fff; font-size: 1.2rem;
        }

        .name { font-size: 0.65rem; font-weight: 600; text-align: center; text-transform: uppercase; }

        /* --- RANKED STATE (When inside Top Zone) --- */
        .rank-zone .card {
            min-width: 80px; /* Horizontal strip sizing */
            background: var(--bg-body);
            border-color: var(--gold); /* Default rank color, JS overrides */
        }

        .rank-badge {
            position: absolute; top: -5px; right: -5px;
            width: 20px; height: 20px; border-radius: 50%;
            background: #fff; color: #000;
            font-size: 10px; font-weight: 800;
            display: flex; align-items: center; justify-content: center;
            display: none; /* Hidden in pool */
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            z-index: 10;
        }

        .rank-zone .card .rank-badge { display: flex; } /* Show in ranking */
        
        /* Rank Colors */
        .card[data-rank="1"] .rank-badge { background: var(--gold); }
        .card[data-rank="1"] .img-wrap { border-color: var(--gold); }
        
        .card[data-rank="2"] .rank-badge { background: var(--silver); }
        .card[data-rank="2"] .img-wrap { border-color: var(--silver); }
        
        .card[data-rank="3"] .rank-badge { background: var(--bronze); }
        .card[data-rank="3"] .img-wrap { border-color: var(--bronze); }

        .card[data-rank="4"] .rank-badge, .card[data-rank="5"] .rank-badge { background: var(--rank-other); color: #fff; }
        .card[data-rank="4"] .img-wrap, .card[data-rank="5"] .img-wrap { border-color: var(--rank-other); }

        /* --- FOOTER --- */
        .footer-bar {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            width: 90%; max-width: 400px;
            background: rgba(20,20,20,0.95);
            backdrop-filter: blur(15px);
            border: 1px solid var(--border-subtle);
            border-radius: 50px;
            padding: 10px 10px 10px 25px;
            display: flex; align-items: center; justify-content: space-between;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 100;
        }
        body.light-mode .footer-bar { background: rgba(255,255,255,0.95); }

        .status { font-size: 0.75rem; color: var(--text-muted); }
        .status b { color: var(--text-main); }

        .submit-btn {
            background: var(--btn-bg); color: var(--btn-text);
            border: none; padding: 12px 24px; border-radius: 30px;
            font-weight: 700; font-family: 'Outfit', sans-serif;
            cursor: pointer; opacity: 0.5; pointer-events: none;
            transition: all 0.3s;
        }
        .submit-btn.ready { opacity: 1; pointer-events: auto; }

    </style>
</head>
<body>

    <header>
        <div class="logo">Eco Campus</div>
        <div class="sub-logo">Ranked Preference Ballot</div>
        <button class="theme-btn" onclick="toggleTheme()"><i class="fas fa-adjust"></i></button>
    </header>

    <div class="container">

        <div class="category-block">
            <div class="cat-title">Mr. Birla Ranking</div>
            
            <div class="rank-zone" id="boys-rank"></div>
            
            <div class="pool-zone" id="boys-pool"></div>
        </div>

        <div class="category-block">
            <div class="cat-title">Miss. Birla Ranking</div>
            
            <div class="rank-zone" id="girls-rank"></div>
            
            <div class="pool-zone" id="girls-pool"></div>
        </div>

    </div>

    <div class="footer-bar">
        <div class="status" id="status-text">Select candidates...</div>
        <button class="submit-btn" id="submitBtn" onclick="confirmVote()">CONFIRM</button>
    </div>

    <script>
        // DATA
        const DATA = {
            boys: [
                { id: "b1", name: "Aashish", icon: "fa-user-tie", img: "" },
                { id: "b2", name: "Krushna", icon: "fa-laptop-code", img: "" },
                { id: "b3", name: "Suraj", icon: "fa-user", img: "" },
                { id: "b4", name: "Yashraj", icon: "fa-dumbbell", img: "" },
                { id: "b5", name: "Prasad", icon: "fa-star", img: "" }
            ],
            girls: [
                { id: "g1", name: "Vaidehi", icon: "fa-crown", img: "" },
                { id: "g2", name: "Ekta", icon: "fa-star", img: "" },
                { id: "g3", name: "Divya", icon: "fa-heart", img: "" },
                { id: "g4", name: "Dharani", icon: "fa-music", img: "" },
                { id: "g5", name: "Kaustubhi", icon: "fa-camera", img: "" }
            ]
        };

        // --- INIT ---
        window.onload = function() {
            if(localStorage.getItem('voteLocked') === 'true') {
                document.body.innerHTML = "<div style='display:flex; height:100vh; align-items:center; justify-content:center; flex-direction:column;'><h2>Vote Locked</h2><p>Thank you for voting.</p></div>";
                return;
            }

            // Shuffle and Render Pool
            shuffle(DATA.boys);
            shuffle(DATA.girls);
            
            renderPool('boys', DATA.boys);
            renderPool('girls', DATA.girls);
        };

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function renderPool(type, candidates) {
            const pool = document.getElementById(`${type}-pool`);
            candidates.forEach(c => {
                pool.appendChild(createCardElement(c, type));
            });
        }

        function createCardElement(c, type) {
            const el = document.createElement('div');
            el.className = 'card';
            el.id = c.id;
            el.onclick = () => moveCard(c.id, type);

            const visual = c.img 
                ? `<img src="${c.img}" alt="${c.name}">` 
                : `<i class="fas ${c.icon}"></i>`;

            el.innerHTML = `
                <div class="rank-badge"></div>
                <div class="img-wrap">${visual}</div>
                <div class="name">${c.name}</div>
            `;
            return el;
        }

        // --- LOGIC ---
        function moveCard(id, type) {
            const card = document.getElementById(id);
            const rankZone = document.getElementById(`${type}-rank`);
            const poolZone = document.getElementById(`${type}-pool`);

            // Check parent to see where it currently is
            if (card.parentElement === poolZone) {
                // MOVE TO RANK
                // Check limit (technically limit is 5, which is all of them)
                // Just append to rank zone
                rankZone.appendChild(card);
            } else {
                // MOVE BACK TO POOL
                poolZone.appendChild(card);
            }

            updateRanks(type);
            checkStatus();
        }

        function updateRanks(type) {
            const rankZone = document.getElementById(`${type}-rank`);
            const cards = rankZone.querySelectorAll('.card');

            cards.forEach((card, index) => {
                const rank = index + 1;
                card.setAttribute('data-rank', rank);
                card.querySelector('.rank-badge').innerText = rank;
            });
        }

        function checkStatus() {
            const bCount = document.getElementById('boys-rank').children.length;
            const gCount = document.getElementById('girls-rank').children.length;
            const total = bCount + gCount;
            const required = 10;

            const statusTxt = document.getElementById('status-text');
            const btn = document.getElementById('submitBtn');

            if (total === required) {
                statusTxt.innerHTML = `<span style="color:var(--gold); font-weight:800;">Ready to Confirm</span>`;
                btn.classList.add('ready');
            } else {
                statusTxt.innerHTML = `Ranked <b>${total}</b> / ${required}`;
                btn.classList.remove('ready');
            }
        }

        // --- ACTIONS ---
        function confirmVote() {
            Swal.fire({
                title: 'Confirm Ranking?',
                text: "Your order: 1st (Gold) to 5th.",
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: 'Lock Vote',
                confirmButtonColor: document.body.classList.contains('light-mode') ? '#000' : '#fff',
                background: document.body.classList.contains('light-mode') ? '#fff' : '#111',
                color: document.body.classList.contains('light-mode') ? '#000' : '#fff'
            }).then((res) => {
                if(res.isConfirmed) {
                    localStorage.setItem('voteLocked', 'true');
                    location.reload();
                }
            });
        }

        function toggleTheme() {
            document.body.classList.toggle('light-mode');
        }

    </script>
</body>
</html>
